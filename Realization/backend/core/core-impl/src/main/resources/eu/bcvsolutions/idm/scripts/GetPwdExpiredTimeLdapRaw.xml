<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!--
Returns password expire date in LDAP raw UTC date format YYYYMMddHHmmssZ.
-->
<script xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="IdmScript.xsd">
  <code>GetPwdExpiredTimeLdapRaw</code>
  <name>GetPwdExpiredTimeLdapRaw</name>
  <body><![CDATA[package eu.bcvsolutions.idm.scripts.rules;

import org.joda.time.LocalDate;

/**
 * code: GetPwdExpiredTimeLdapRaw
 * name: Get password expired time
 * desc: Returns password expire date in LDAP raw UTC date format YYYYMMddHHmmssZ.
 * authorities:
 * - org.joda.time.LocalDate
 *
 * @author Jan Helbich
 */
//
//IdmIdentity entity
//
LocalDate expireDate = scriptEvaluator.evaluate(scriptEvaluator.newBuilder()
        .setScriptCode('getPwdExpiredTime')
        .addParameter('scriptEvaluator', scriptEvaluator)
        .addParameter('entity', entity)
        .build())
//
if (expireDate == null) {
    return null;
}
//
return expireDate.toString("YYYYMMdd000000") + "Z"]]></body>
<type>groovy</type>
  <category>TRANSFORM_TO</category>
  <description>Returns password expire date in LDAP raw UTC date format YYYYMMddHHmmssZ.</description>  
<allowClasses>
    <allowClass>
        <className>org.joda.time.LocalDate</className>
    </allowClass>
</allowClasses>
</script>
