<?xml version = "1.0" encoding = "UTF-8" standalone = "yes"?>
<!--
/**
 *
 * Script returns GuardedString
 *
 */
-->
<script xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="IdmScript.xsd">
    <code>GetGuardedString</code>
    <name>GetGuardedString</name>
    <body>
        <![CDATA[
import eu.bcvsolutions.idm.core.security.api.domain.GuardedString;

if (!attributeValue) {
    return null;
}
if (attributeValue.class == GuardedString) {
    return attributeValue;
}
return new GuardedString(attributeValue);
  		]]>
    </body>
    <type>groovy</type>
    <category>TRANSFORM_TO</category>
    <parameters>attributeValue</parameters>
    <services>
        <!-- not needed -->
    </services>
    <allowClasses>
        <allowClass>
            <className>eu.bcvsolutions.idm.core.security.api.domain.GuardedString</className>
        </allowClass>
    </allowClasses>
</script>