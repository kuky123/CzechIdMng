<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!--
Returns if identity's account is in protection.
-->
<script xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="IdmScript.xsd">
  <code>IsAccountInProtection</code>
  <name>IsAccountInProtection</name>
  <body><![CDATA[package eu.bcvsolutions.idm.scripts.rules
import eu.bcvsolutions.idm.acc.dto.AccAccountDto

/**
 * code: IsAccountInProtection
 * name: IsAccountInProtection
 * desc:
 * Returns if identity's account is in protection.
 * Input:
 *   entity - IdmIdentity
 *   system - SysSystem
 * Output:
 *   boolean inProtection - account is in protection
 *
 * authorities:
 * - eu.bcvsolutions.idm.acc.entity.AccAccount
 *
 * @author Jan Helbich
 */
// IdmIdentity entity
// SysSystem system
//
AccAccountDto account = scriptEvaluator.evaluate(scriptEvaluator.newBuilder()
        .setScriptCode('GetIdentityAccAccount')
        .addParameter('scriptEvaluator', scriptEvaluator)
        .addParameter('entity', entity)
        .addParameter('system', system)
        .addParameter('uid', uid)
        .build());
//
return account == null ? false : account.inProtection;]]></body>
  <type>groovy</type>
  <category>TRANSFORM_TO</category>
  <description>Returns if identity's account is in protection.</description>
<allowClasses>
  <allowClass>
    <className>eu.bcvsolutions.idm.acc.dto.AccAccountDto</className>
  </allowClass>
</allowClasses>
</script>
